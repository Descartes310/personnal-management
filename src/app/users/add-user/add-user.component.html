<div class="app-page-title">
    <div class="page-title-wrapper">
        <div class="page-title-heading" style="width: 100%;">
            <div class="page-title-icon">
                <i class="pe-7s-id icon-gradient bg-ripe-malin">
                </i>
            </div>
            <div>{{ 'User.Users' | translate }}
                <div class="page-title-subheading">{{ 'User.UserTitle' | translate }}
                </div>
            </div>
        </div>   
    </div>
</div>   

<div class="row">
    <div class="col-md-12">
        <div class="tabs-animation">
            <div class="main-card mb-3 card">

                <div class="card-header">
                    <i class="header-icon pe-7s-id icon-gradient bg-love-kiss"> </i>
                    {{ 'User.Users' | translate }}
                </div>

                <div class="card-body">

                    <div class="row">
                        <div class="col-md-12">
                            <div class="main-card mb-3 card">
                                <div *ngIf="isBuild" class="card-body">

                                    <mat-horizontal-stepper linear #stepper>

                                        <mat-step [stepControl]="personnalInfoForm" [optional]="isOptional">

                                            <form [formGroup]="personnalInfoForm">
                                                <ng-template matStepLabel>{{ 'User.UserFormFirstStepName' | translate }}</ng-template>

                                                <div *ngFor="let input of firstStepInputList">
                                                    <div class="position-relative form-group">

                                                        <label>{{ input.name }} <span *ngIf="input.is_required" style="color: red;"> *</span></label>
                                                        
                                                        <input *ngIf="!checkIfInputIsASelect(input)" [formControlName]="input.name" type="{{ input.type }}" placeholder="{{ input.placeholder }}" min="{{ input.min }}" max="{{ input.max }}" step="{{ input.step }}" value="{{ input.default }}" class="form-control {{ isSubmitted && personnalInfo[input.name].errors ? 'is-invalid' : '' }}" [required]="input.is_required">

                                                        <input *ngIf="checkIfInputIsAFile(input)" [formControlName]="input.name" type="{{ input.type }}" class="form-control {{ isSubmitted && personnalInfo[input.name].errors ? 'is-invalid' : '' }}" [required]="input.is_required">

                                                        <select *ngIf="checkIfInputIsASelect(input)" matInput [formControlName]="input.name" class="form-control isSubmitted && personnalInfo[input.name].errors ? 'is-invalid' : ''">
                                                            <option *ngFor='let option of input.options' value=" {{ option.value }}"> {{ option.key }}</option>
                                                        </select>

                                                    </div>
                                                </div>

                                                <div>
                                                    <button class="btn btn-primary btn-md m-2" mat-button matStepperNext (click)="validatePersonnalInfoForm()">Next</button>
                                                </div>
                                            </form>

                                        </mat-step>

                                        <mat-step [stepControl]="publicInfoForm" [optional]="isOptional">

                                            <form [formGroup]="publicInfoForm">
                                                <ng-template matStepLabel>{{ 'User.UserFormSecondStepName' | translate}}</ng-template>

                                                <div *ngFor="let input of secondStepInputList">
                                                    <div class="position-relative form-group">

                                                        <label>{{ input.name }}: <span *ngIf="input.is_required" style="color: red;"> *</span></label>
                                                        
                                                        <input *ngIf="!checkIfInputIsASelect(input)" [formControlName]=" input.name" type="{{ input.type }}" placeholder="{{ input.placeholder }}" min="{{ input.min }}" max="{{ input.max }}" value="{{ input.default }}" class="form-control {{ isSubmitted && publicInfo[input.name].errors ? 'is-invalid' : '' }} " [required]="input.is_required">
 
                                                        <select *ngIf="checkIfInputIsASelect(input)" matInput [formControlName]="input.name" class="form-control isSubmitted && publicInfo[input.name].errors ? 'is-invalid' : ''">
                                                            <option *ngFor='let option of input.options' value="{{ option.value }}" [selected]="checkIfSelected(input, option)"> {{ option.key }}</option>
                                                        </select>

                                                    </div>
                                                </div>

                                                <div>
                                                    <button class="btn btn-primary btn-md m-2" mat-button matStepperPrevious>Back</button>
                                                    <button class="btn btn-primary btn-md m-2" mat-button matStepperNext (click)="validatePublicInfoForm()">Next</button>
                                                </div>
                                            </form>

                                        </mat-step>

                                        <mat-step>

                                            <ng-template matStepLabel>{{ 'User.FinishTitle' | translate }}</ng-template>

                                            <div class="no-results">
                                                <div class="swal2-icon swal2-success swal2-animate-success-icon">
                                                    <div class="swal2-success-circular-line-left" style="background-color: rgb(255, 255, 255);"></div>
                                                    <span class="swal2-success-line-tip"></span>
                                                    <span class="swal2-success-line-long"></span>
                                                    <div class="swal2-success-ring"></div>
                                                    <div class="swal2-success-fix" style="background-color: rgb(255, 255, 255);"></div>
                                                    <div class="swal2-success-circular-line-right" style="background-color: rgb(255, 255, 255);"></div>
                                                </div>

                                                <div class="results-subtitle mt-4">{{ 'User.FinishSubtitle' | translate }}</div>
                                                <div class="results-title">Veuillez Sauvegarder</div>
                                                <div class="mt-3 mb-3"></div>
                                                <div class="text-center">
                                                    <button (click)="onSubmit()" [disabled]="isLoading" class="btn btn-primary btn-lg" style="width: 50%; justify-content: center; align-items: center; flex: 1;">
                                                            <p *ngIf="!isLoading" style="font-size: 1.2em; padding: 0px; margin: 5px;">{{ "Contact.CreateContact" | translate }}</p>
                                                            <div *ngIf="isLoading" style="padding: 15px; margin-left: 50%;">
                                                                <div class="ball-scale-multiple">
                                                                    <div style="background-color: white;"></div>
                                                                    <div style="background-color: white;"></div>
                                                                    <div style="background-color: white;"></div>
                                                                </div>
                                                            </div>
                                                    </button>
                                                </div>
                                            </div>

                                            <div>
                                                <button class="btn btn-primary btn-md m-2" mat-button matStepperPrevious>Back</button>
                                                <button class="btn btn-primary btn-md m-2" mat-button (click)="stepper.reset()">Reset</button>
                                            </div>

                                        </mat-step>

                                    </mat-horizontal-stepper>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>

            </div>
        </div>
    </div>
</div>
